<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head data-vp="http://{{host}}/portalProject/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" >
    <title>课程中心</title>
    <link href="css/base.css" rel="stylesheet" />
    <link href="css/profession.css" rel="stylesheet" />
    <link href="css/yui.css" rel="stylesheet" />
    <style type="text/css">
       .newaddpic {
           width: 65px;
           height: 52px;
           background: url(../sta_page/img/shifan.png);
           position: absolute;
           top: 0;
           right: 0;
           z-index: 100;
       }
       .header-logo{width: 620px; height:100px;}
		.header-logo img{width:100px;vertical-align: middle;}
		.header-logo h2{width: 500px;}
   </style>
</head>
<body style="background-color: #fff;">
    <div class="header">
        <div class="header-inner clefix">
            <span class="header-logo" id="logo">
                <img src="/portalProject/themes/sta_page/img/smile.jpg" width="353" height="100">
                <h2></h2>
            </span>
            <div class="login-wrapper">
                <div class="login-inner">
                    <a href="/portal" class="login-link" id="login-btn">返回首页</a>
                </div>
                <div class="personal-center" style="display: none;">
                    <div class="center-group">
                        <a href="javascript:;" class="center-link">消息(2)</a>
                        <a href="javascript:;" class="center-link">个人中心</a>
                        <a href="javascript:;" class="center-link">退出</a>
                    </div>
                </div>
            </div>
            <div class="header-nav">
                <ul class="nav-group">
                    <li class="nav-i"><a href="index.html" class="nav-link ">专业首页</a>
                    </li>
                    <li class="nav-i"><a href="major_garden.html" class="nav-link">专业园地</a>
                    </li>
                    <li class="nav-i"><a href="course.html" class="nav-link current">课程中心</a>
                    </li>
                    <li class="nav-i"><a href="smallcourse.html" class="nav-link">微课中心</a>
                    </li>                 
                     <li class="nav-i"><a href="material.html" class="nav-link">素材中心</a>
                    </li>
                    <li class="nav-i"><a href="industry_resources.html" class="nav-link">行业资源</a>
                    </li>
                    <li class="nav-i"><a href="corporate_training.html" class="nav-link">企业培训</a>
                    </li>
                    <li class="nav-i"><a href="skill_textual_research.html" class="nav-link">技能考证</a>
                    </li>
                    <li class="nav-i"><a href="yidaiyilu.html" class="nav-link">"一带一路"</a>
                    </li>
                    </li>
                    <li class="nav-i"><a href="practical_training_base.html" class="nav-link">实训基地</a>
                    </li>
                    <li class="nav-i"><a href="skill_practice.html" class="nav-link">技能训练</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="wrapper">
    <div class="wrapper-inner">
        <div class="yui3-g">
            <input type="hidden" name="projectId" value="" />
            <input type="hidden" name="schoolId" />
            <input type="hidden" name="page" value="1" />
            <input type="hidden" name="searchName" />
            <input type="hidden" name="tag" />
            <div class="yui3-u-3-4">
                <div class="primary">
                    <div class="data-list" id="course_html">
                    </div>

                    <div class="section-course pagination" id="pagination">
                    </div>
                </div>
            </div>

            <div class="yui3-u-1-4">
                <div class="sidebar">

                    <div class="widgets view-row">
                    </div>

                    <div class="widgets widegets-search clefix">
                        <div class="search-inner clefix">
                            <input type="text" value="" name="couse_name" class="search-input">
                        </div>
                        <button type="button" class="search-btn" id="searchCourseName"></button>
                    </div>

                    <div class="widgets widegets-list">
                        <h3>学校•企业</h3>
                        <ul class="art-list" id="school_enterprise_html">
                        </ul>
                        <div class="more-school" id="more-company"><a href="#">选择其他学校.企业</a></div>
                    </div>

                    <div class="widgets widegets-list">
                        <h3>热门标签</h3>
                        <div class="tags" id="tag_html">
                        </div>
                    </div>

                </div>
            </div>

        </div>
    </div>
</div>
    <script id="course" type="text/html">
        <!if(course_hot.length==0){!>
        没有符合条件的信息
        <!}!>
    <! for(var i = 0; i < course_hot.length; i++) { !>
           <div class="data-row">
               <div class="data-inner clefix">
                   <div class="data-thumb">
                       <div class="img-scale" style="position:relative">
                           <!--标识示范课与非示范课-->
                              <!if(course_hot[i].courseType=="示范课"){!>                
                           <div class="newaddpic"></div>
                             <!}!>

                           <a href="/portal/courseinfo?courseid=<!=course_hot[i].id!>" target="_blank">
                               <!if(course_hot[i].cover==""){!>
                              <img src="/portalProject/themes/sta_page/img/no_thumbnail.jpg" width="270" height="152"></a>
                           <!}else{!>
                             <img src="<!=course_hot[i].cover!>" width="270" height="190"></a>
                          <!}!>                                 
                       </div>
                   </div>
                   <h3 class="data-title"><a href="/portal/courseinfo?courseid=<!=course_hot[i].id!>" title="<!=course_hot[i].coursetitle!>">
                       <!if(course_hot[i].coursetitle.length>8){!>
                                   <!=course_hot[i].coursetitle.substr(0,8)+"..."!>
                                  <!}else{!>
                                  <!=course_hot[i].coursetitle!>
                                  <!}!>
                                          </a></h3>
                   <div class="data-teacher">
                       <span><!if(course_hot[i].displayname==""){!>
                           暂无主持教师
                       <!}else{!>
                        <!=course_hot[i].displayname!>
                       <!}!>
                       </span>
                   </div>
                   <div class="data-job"><!=course_hot[i].unitname!></div>
                   <div class="data-desc">
                       <!if(course_hot[i].CourseDes.length>100){!>
                            <!=course_hot[i].CourseDes.substr(0,100)+"...."!>
                       <!}else if(course_hot[i].CourseDes.length==0){!>
                       暂无推荐词
                       <!}else{!>
                       <!=course_hot[i].CourseDes!>
                       <!}!>
                   </div>
                   <div class="data-info">
                       <a href="/portal/courseinfo?courseid=<!=course_hot[i].id!>" class="link" target="_blank">查看详细</a>
                       <span class="time mr"><!=course_hot[i].time!></span>
                       <span class="count"><!=course_hot[i].peoplecount!></span>
                   </div>
               </div>
           </div>
        <! } !> 
    </script>

    <script id="school_enterprise" type="text/html">
        <! for(var i = 0; i < school_enter.length; i++) { !>
       <li><a href="#" data-id="<!=school_enter[i].id!>" title="<!=school_enter[i].name!>">
	    <!if(school_enter[i].name.length>10){!>
            <!=school_enter[i].name.substr(0,10)+"..."!>
           <!}else{!>
           <!=school_enter[i].name!>
           <!}!>
	   <span style="margin-left: 20px; color: red;">(<!=school_enter[i].coursecount!>)</span></a></li>
        <! } !> 
    </script>

    <script id="tag" type="text/html">
        <! for(var i = 0; i < tag.length; i++) { !>
         <a href="#"><!=tag[i]!></a>
        <! } !> 
    </script>

  <script id="page_html" type="text/html">
        <!if(totalPageCount>1){!>
        <!if(pageCurrent!=1){!>
         <a href="?page=<!=pageCurrent-1!>" data-page="<!=pageCurrent-1!>" title="上一页" class="prev">‹</a>
        <! } !> 
            <! for(var i = 1; i <totalPageCount+1; i++) { !>
             <!if(pageCurrent==i){!>
               <a href="?page=<!=i!>" data-page="<!=i!>" class="current"><!=i!></a>
        <!}else{!>
               <a href="?page=<!=i!>" data-page="<!=i!>"><!=i!></a>
        <! } !> 
         <! } !> 
        
         <!if(pageCurrent!=totalPageCount){!>
          <a href="?page=<!=pageCurrent+1!>" data-page="<!=pageCurrent+1!>" title="下一页" class="next">›</a>
        <! } !> 
    <! } !> 
    </script> 

    <script id="link_html" type="text/html">
        <! for(var i = 0; i < link.length; i++) { !>
             <a href="<!=link[i].url!>" target="_blank"><!=link[i].name!></a>
        <! } !> 
    </script>

       <div class="footer">
        <div class="footer-inner">
            <div class="footer-left" id="footerLeft">
            </div>
            <div class="footer-right">
                <h3 class="footer-logo">&nbsp;</h3>
                <div class="footer-text">
                    <p>
                        <a href='/portal/platform?page=1' target="_blank">平台简介</a>&nbsp;|&nbsp;
         
                        <a href='/portal/platform?page=2' target="_blank">知识产权</a>&nbsp;|&nbsp;
         
                        <a href='/portal/platform?page=3' target="_blank">免责声明</a>&nbsp;|&nbsp;
         
                        <a href='/portal/platform?page=4' target="_blank">意见反馈</a>&nbsp;|&nbsp;
         
                        <a href='/portal/platform?page=5' target="_blank">联系我们</a>
                    </p>
                </div>

            </div>
            <div class="footer-copyright" style="padding-left: 100px;">
                <span>Copyright©www.icve.com.cn</span>
                <a href="http://www.miitbeian.gov.cn/" class="copyright-ICP">京ICP备12020869-19</a>
            </div>
        </div>
    </div>
    <script src="/portalProject/js/common/jquery.js"></script>
    <script src="/portalProject/js/common/showDialog.js"></script>
    <script src="/portalProject/js/interface/Sub_Project_Interface.js"></script>
    <script src="/portalProject/js/interface/Sub_Project_Index.js"></script>
    <script src="/portalProject/js/interface/BaiduTemplate.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {

            $('input[name=projectId]').val(jQuery.query.get(projectId).projectId);
            //使用baidu.template命名空间
            var bt = baidu.template;

            //可以设置分隔符
            bt.LEFT_DELIMITER = '<!';
            bt.RIGHT_DELIMITER = '!>';

            //可以设置输出变量是否自动HTML转义
            //bt.ESCAPE = false;

            //专业Id
            var projectId = $('input[name=projectId]').val();

            //分页page
            var page = $('input[name=page]').val();

            //所属课程
            var data = {
                projectId: projectId,
                hot: false,
                pagesize: 5,
                page: page,
                order: 'asc'
            }

            //获取logo  start
            var logos = sub_project.getLogo(projectId);
            var projectname=logos.projectName+"专业教学资源库";
            console.log(projectname);
            $("#logo img").attr("src", logos.logoUrl);
            $("#logo h2").attr("title",logos.projectName);
            $("#logo h2").text(projectname);
            //end

            var courseList = function (data) {
                var get_course = sub_project.course(data);
				console.log(get_course);
                var course_hot = {
                    course_hot: get_course.course.obj
                }
                var course_html = bt('course', course_hot);     //绑定所属课程

                document.getElementById('course_html').innerHTML = course_html;//渲染

                //分页数据
                var pagination = {
                    pageCurrent: parseInt(get_course.pageCurrent),
                    totalPageCount: get_course.totalPageCount
                }

                //绑定所属分页
                var page_html = bt('page_html', pagination);
                document.getElementById('pagination').innerHTML = page_html;//渲染
            }

            //学校·企业 start
            var get_schoolEnter = sub_project.school_enterprise(projectId, 1, 1);
            var school_enter = {
                school_enter: get_schoolEnter.data.schoolEnter
            }
            var school_enterprise_html = bt('school_enterprise', school_enter);
            document.getElementById('school_enterprise_html').innerHTML = school_enterprise_html;//渲染
            // end

            //课程标签 start
            var get_tag = sub_project.course_tag(projectId, 1, 1);

            var tag = {
                tag: get_tag.tag
            }
            var tag_html = bt('tag', tag);
            document.getElementById('tag_html').innerHTML = tag_html;//渲染
            //end

            //学校·企业获取课程值
            var clickGetData = function (type) {

                var schoolOfData = {
                    projectId: projectId,
                    hot: false,
                    pagesize: 5,
                    page: 1,
                    school_enter: $("input[name=schoolId]").val(),
                    search_name: $("input[name=searchName]").val(),
                    tag: $("input[name=tag]").val(),
                    type: type != undefined ? false : true,
                    classify: 1
                }
                courseList(schoolOfData);
            }

            //点击列表中的学校·企业
            $("#school_enterprise_html a").click(function () {
                //每次点击重新赋值数据，避免分页过后查询的是全部信息
                $("input[name=schoolId]").val($(this).data("id"));
                $("input[name=searchName]").val("");
                $("input[name=tag]").val("");
                clickGetData();
            });

            //绑定分页
            $('.pagination').on('click', 'a', function () {
                page = $(this).attr("data-page");
                $('.pagination a').removeClass('current');
                $(this).addClass('current');

                //加其他参数
                var paginationData = {
                    projectId: projectId,
                    hot: false,
                    pagesize: 5,
                    page: page,
                    tag: $("input[name=tag]").val(),
                    school_enter: $("input[name=schoolId]").val(),
                    search_name: $("input[name=searchName]").val()
                }
                courseList(paginationData);
                return false;
            });

            //右侧搜索框
            $("#searchCourseName").click(function () {
                $("input[name=searchName]").val($("input[name=couse_name]").val());
                $("input[name=schoolId]").val("");
                $("input[name=tag]").val("");
                clickGetData(false);
            });

            //点击标签查询
            $("#tag_html a").click(function () {
                $("input[name=tag]").val($(this).text());
                $("input[name=schoolId]").val(""),
                $("input[name=searchName]").val("")
                clickGetData(false);
                return false;
            });

            //友情链接
            var get_friendLink = sub_project.get_footer(projectId).data;
            var link = {
                link: get_friendLink
            }
            var link_htmls = bt('link_html', link);
            document.getElementById('footerLeft').innerHTML = link_htmls;//渲染

            //学校·企业加载更多
            $('#more-company').showDialog({
                id: 'more_school',//dialogId（自定义）
                type: 'get',
                title: '学校·企业列表',
                data: { projectId: projectId, type: 1, classify: 1 },
                inputName: 'key',
                dataURL: $("head").data("vp").replace("{{host}}", window.location.host) + 'ajax-portalpoject-getSchoolEnterprise_More?page={autoPage}',
                searchURL: $("head").data("vp").replace("{{host}}", window.location.host) + 'ajax-portalpoject-getSchoolEnterprise_More?page={autoPage}',
                before: function () { },
                callback: function () {
                    var _this = this;
                    //点击dialog获取课程值
                    $("#more_school li a").click(function () {
                        $("input[name=schoolId]").val($(this).data("id"));
                        clickGetData();
                        _this.dialog.hide();
                    });

                }
            });


            //页面加载调用方法
            courseList(data);

        });
    </script>
</body>
</html>
